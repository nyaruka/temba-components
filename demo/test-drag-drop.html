<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="utf-8" />
    <title>Test Drag and Drop</title>
    <link href="/static/css/temba-components.css" rel="stylesheet" type="text/css" />
    <style>
        body { 
            font-family: sans-serif; 
            padding: 20px; 
            max-width: 600px;
            margin: 0 auto;
        }
        .test-container { 
            margin: 20px 0; 
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-container h3 {
            margin-top: 0;
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Drag and Drop Test</h1>
    
    <div class="test-container">
        <h3>Multi-select with 3 items (should have horizontal layout and drag/drop)</h3>
        <temba-select multi id="test3">
            <temba-option name="Red" value="0" selected></temba-option>
            <temba-option name="Green" value="1" selected></temba-option>
            <temba-option name="Blue" value="2" selected></temba-option>
        </temba-select>
        <div style="margin-top: 10px;">
            Current values: <span id="values3"></span>
        </div>
    </div>
    
    <div class="test-container">
        <h3>Multi-select with 2 items (should have drag/drop)</h3>
        <temba-select multi id="test2">
            <temba-option name="Apple" value="apple" selected></temba-option>
            <temba-option name="Banana" value="banana" selected></temba-option>
        </temba-select>
        <div style="margin-top: 10px;">
            Current values: <span id="values2"></span>
        </div>
    </div>

    <div class="test-container">
        <h3>Multi-select with 1 item (should NOT have drag/drop)</h3>
        <temba-select multi id="test1">
            <temba-option name="Solo" value="solo" selected></temba-option>
        </temba-select>
        <div style="margin-top: 10px;">
            Current values: <span id="values1"></span>
        </div>
    </div>
    
    <script type="module">
        import '/out-tsc/temba-modules.js';
        
        function updateValues() {
            const test3 = document.getElementById('test3');
            const test2 = document.getElementById('test2');
            const test1 = document.getElementById('test1');
            
            document.getElementById('values3').textContent = test3.values.map(v => v.name).join(', ');
            document.getElementById('values2').textContent = test2.values.map(v => v.name).join(', ');
            document.getElementById('values1').textContent = test1.values.map(v => v.name).join(', ');
        }
        
        window.addEventListener('load', () => {
            setTimeout(() => {
                updateValues();
                
                // Add change listeners
                document.querySelectorAll('temba-select').forEach(select => {
                    select.addEventListener('change', updateValues);
                });
                
                // Check if sortable lists exist
                console.log('=== Sortable List Check ===');
                document.querySelectorAll('temba-select').forEach(select => {
                    const sortableList = select.shadowRoot?.querySelector('temba-sortable-list');
                    console.log(`${select.id}: has sortable list = ${!!sortableList}, horizontal = ${sortableList?.horizontal}`);
                });
            }, 500);
        });
    </script>
</body>
</html>